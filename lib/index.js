"use strict";

var colorConvert = require('color-convert');

var wrapAnsi16 = function wrapAnsi16(fn, offset) {
  return function () {
    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
      args[_key] = arguments[_key];
    }

    var code = fn.apply(colorConvert, args);
    return "\x1B[".concat(code + offset, "m");
  };
};

var wrapAnsi256 = function wrapAnsi256(fn, offset) {
  return function () {
    for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
      args[_key2] = arguments[_key2];
    }

    var code = fn.apply(colorConvert, args);
    return "\x1B[".concat(38 + offset, ";5;").concat(code, "m");
  };
};

var wrapAnsi16m = function wrapAnsi16m(fn, offset) {
  return function () {
    for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {
      args[_key3] = arguments[_key3];
    }

    var rgb = fn.apply(colorConvert, args);
    return "\x1B[".concat(38 + offset, ";2;").concat(rgb[0], ";").concat(rgb[1], ";").concat(rgb[2], "m");
  };
};

function assembleStyles() {
  var codes = new Map();
  var styles = {
    modifier: {
      reset: [0, 0],
      // 21 isn't widely supported and 22 does the same thing
      bold: [1, 22],
      dim: [2, 22],
      italic: [3, 23],
      underline: [4, 24],
      inverse: [7, 27],
      hidden: [8, 28],
      strikethrough: [9, 29]
    },
    color: {
      black: [30, 39],
      red: [31, 39],
      green: [32, 39],
      yellow: [33, 39],
      blue: [34, 39],
      magenta: [35, 39],
      cyan: [36, 39],
      white: [37, 39],
      gray: [90, 39],
      // Bright color
      redBright: [91, 39],
      greenBright: [92, 39],
      yellowBright: [93, 39],
      blueBright: [94, 39],
      magentaBright: [95, 39],
      cyanBright: [96, 39],
      whiteBright: [97, 39]
    },
    bgColor: {
      bgBlack: [40, 49],
      bgRed: [41, 49],
      bgGreen: [42, 49],
      bgYellow: [43, 49],
      bgBlue: [44, 49],
      bgMagenta: [45, 49],
      bgCyan: [46, 49],
      bgWhite: [47, 49],
      // Bright color
      bgBlackBright: [100, 49],
      bgRedBright: [101, 49],
      bgGreenBright: [102, 49],
      bgYellowBright: [103, 49],
      bgBlueBright: [104, 49],
      bgMagentaBright: [105, 49],
      bgCyanBright: [106, 49],
      bgWhiteBright: [107, 49]
    }
  }; // Fix humans

  styles.color.grey = styles.color.gray;

  var _arr = Object.keys(styles);

  for (var _i = 0; _i < _arr.length; _i++) {
    var groupName = _arr[_i];
    var group = styles[groupName];

    var _arr3 = Object.keys(group);

    for (var _i3 = 0; _i3 < _arr3.length; _i3++) {
      var styleName = _arr3[_i3];
      var style = group[styleName];
      styles[styleName] = {
        open: "\x1B[".concat(style[0], "m"),
        close: "\x1B[".concat(style[1], "m")
      };
      group[styleName] = styles[styleName];
      codes.set(style[0], style[1]);
    }

    Object.defineProperty(styles, groupName, {
      value: group,
      enumerable: false
    });
    Object.defineProperty(styles, 'codes', {
      value: codes,
      enumerable: false
    });
  }

  var ansi2ansi = function ansi2ansi(n) {
    return n;
  };

  var rgb2rgb = function rgb2rgb(r, g, b) {
    return [r, g, b];
  };

  styles.color.close = '\u001B[39m';
  styles.bgColor.close = '\u001B[49m';
  styles.color.ansi = {
    ansi: wrapAnsi16(ansi2ansi, 0)
  };
  styles.color.ansi256 = {
    ansi256: wrapAnsi256(ansi2ansi, 0)
  };
  styles.color.ansi16m = {
    rgb: wrapAnsi16m(rgb2rgb, 0)
  };
  styles.bgColor.ansi = {
    ansi: wrapAnsi16(ansi2ansi, 10)
  };
  styles.bgColor.ansi256 = {
    ansi256: wrapAnsi256(ansi2ansi, 10)
  };
  styles.bgColor.ansi16m = {
    rgb: wrapAnsi16m(rgb2rgb, 10)
  };

  var _arr2 = Object.keys(colorConvert);

  for (var _i2 = 0; _i2 < _arr2.length; _i2++) {
    var key = _arr2[_i2];

    if (typeof colorConvert[key] !== 'object') {
      continue;
    }

    var suite = colorConvert[key];

    if (key === 'ansi16') {
      key = 'ansi';
    }

    if ('ansi16' in suite) {
      styles.color.ansi[key] = wrapAnsi16(suite.ansi16, 0);
      styles.bgColor.ansi[key] = wrapAnsi16(suite.ansi16, 10);
    }

    if ('ansi256' in suite) {
      styles.color.ansi256[key] = wrapAnsi256(suite.ansi256, 0);
      styles.bgColor.ansi256[key] = wrapAnsi256(suite.ansi256, 10);
    }

    if ('rgb' in suite) {
      styles.color.ansi16m[key] = wrapAnsi16m(suite.rgb, 0);
      styles.bgColor.ansi16m[key] = wrapAnsi16m(suite.rgb, 10);
    }
  }

  return styles;
} // Make the export immutable


Object.defineProperty(module, 'exports', {
  enumerable: true,
  get: assembleStyles
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJjb2xvckNvbnZlcnQiLCJyZXF1aXJlIiwid3JhcEFuc2kxNiIsImZuIiwib2Zmc2V0IiwiYXJncyIsImNvZGUiLCJhcHBseSIsIndyYXBBbnNpMjU2Iiwid3JhcEFuc2kxNm0iLCJyZ2IiLCJhc3NlbWJsZVN0eWxlcyIsImNvZGVzIiwiTWFwIiwic3R5bGVzIiwibW9kaWZpZXIiLCJyZXNldCIsImJvbGQiLCJkaW0iLCJpdGFsaWMiLCJ1bmRlcmxpbmUiLCJpbnZlcnNlIiwiaGlkZGVuIiwic3RyaWtldGhyb3VnaCIsImNvbG9yIiwiYmxhY2siLCJyZWQiLCJncmVlbiIsInllbGxvdyIsImJsdWUiLCJtYWdlbnRhIiwiY3lhbiIsIndoaXRlIiwiZ3JheSIsInJlZEJyaWdodCIsImdyZWVuQnJpZ2h0IiwieWVsbG93QnJpZ2h0IiwiYmx1ZUJyaWdodCIsIm1hZ2VudGFCcmlnaHQiLCJjeWFuQnJpZ2h0Iiwid2hpdGVCcmlnaHQiLCJiZ0NvbG9yIiwiYmdCbGFjayIsImJnUmVkIiwiYmdHcmVlbiIsImJnWWVsbG93IiwiYmdCbHVlIiwiYmdNYWdlbnRhIiwiYmdDeWFuIiwiYmdXaGl0ZSIsImJnQmxhY2tCcmlnaHQiLCJiZ1JlZEJyaWdodCIsImJnR3JlZW5CcmlnaHQiLCJiZ1llbGxvd0JyaWdodCIsImJnQmx1ZUJyaWdodCIsImJnTWFnZW50YUJyaWdodCIsImJnQ3lhbkJyaWdodCIsImJnV2hpdGVCcmlnaHQiLCJncmV5IiwiT2JqZWN0Iiwia2V5cyIsImdyb3VwTmFtZSIsImdyb3VwIiwic3R5bGVOYW1lIiwic3R5bGUiLCJvcGVuIiwiY2xvc2UiLCJzZXQiLCJkZWZpbmVQcm9wZXJ0eSIsInZhbHVlIiwiZW51bWVyYWJsZSIsImFuc2kyYW5zaSIsIm4iLCJyZ2IycmdiIiwiciIsImciLCJiIiwiYW5zaSIsImFuc2kyNTYiLCJhbnNpMTZtIiwia2V5Iiwic3VpdGUiLCJhbnNpMTYiLCJtb2R1bGUiLCJn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QUFDRDs7QUFFRCxRQUFJLFNBQVNHLEtBQWIsRUFBb0I7QUFDbEJuRSxhQUFPVSxLQUFQLENBQWF1RCxPQUFiLENBQXFCQyxHQUFyQixJQUE0QnZFLFlBQVl3RSxNQUFNdkUsR0FBbEIsRUFBdUIsQ0FBdkIsQ0FBNUI7QUFDQUksYUFBTzJCLE9BQVAsQ0FBZXNDLE9BQWYsQ0FBdUJDLEdBQXZCLElBQThCdkUsWUFBWXdFLE1BQU12RSxHQUFsQixFQUF1QixFQUF2QixDQUE5QjtBQUNEO0FBQ0Y7O0FBRUQsU0FBT0ksTUFBUDtBQUNELEMsQ0FFRDs7O0FBQ0E2QyxPQUFPUyxjQUFQLENBQXNCZSxNQUF0QixFQUE4QixTQUE5QixFQUF5QztBQUN2Q2IsY0FBWSxJQUQyQjtBQUV2Q2MsT0FBS3pFO0FBRmtDLENBQXpDIiwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgY29sb3JDb252ZXJ0ID0gcmVxdWlyZSgnY29sb3ItY29udmVydCcpO1xuXG5jb25zdCB3cmFwQW5zaTE2ID0gKGZuLCBvZmZzZXQpID0+XG4gIGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICBjb25zdCBjb2RlID0gZm4uYXBwbHkoY29sb3JDb252ZXJ0LCBhcmdzKTtcbiAgICByZXR1cm4gYFxcdTAwMUJbJHtjb2RlICsgb2Zmc2V0fW1gO1xuICB9O1xuXG5jb25zdCB3cmFwQW5zaTI1NiA9IChmbiwgb2Zmc2V0KSA9PlxuICBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgY29uc3QgY29kZSA9IGZuLmFwcGx5KGNvbG9yQ29udmVydCwgYXJncyk7XG4gICAgcmV0dXJuIGBcXHUwMDFCWyR7MzggKyBvZmZzZXR9OzU7JHtjb2RlfW1gO1xuICB9O1xuXG5jb25zdCB3cmFwQW5zaTE2bSA9IChmbiwgb2Zmc2V0KSA9PlxuICBmdW5jdGlvbiguLi5hcmdzKSB7XG4gICAgY29uc3QgcmdiID0gZm4uYXBwbHkoY29sb3JDb252ZXJ0LCBhcmdzKTtcbiAgICByZXR1cm4gYFxcdTAwMUJbJHszOCArIG9mZnNldH07Mjske3JnYlswXX07JHtyZ2JbMV19OyR7cmdiWzJdfW1gO1xuICB9O1xuXG5mdW5jdGlvbiBhc3NlbWJsZVN0eWxlcygpIHtcbiAgY29uc3QgY29kZXMgPSBuZXcgTWFwKCk7XG4gIGNvbnN0IHN0eWxlcyA9IHtcbiAgICBtb2RpZmllcjoge1xuICAgICAgcmVzZXQ6IFswLCAwXSxcbiAgICAgIC8vIDIxIGlzbid0IHdpZGVseSBzdXBwb3J0ZWQgYW5kIDIyIGRvZXMgdGhlIHNhbWUgdGhpbmdcbiAgICAgIGJvbGQ6IFsxLCAyMl0sXG4gICAgICBkaW06IFsyLCAyMl0sXG4gICAgICBpdGFsaWM6IFszLCAyM10sXG4gICAgICB1bmRlcmxpbmU6IFs0LCAyNF0sXG4gICAgICBpbnZlcnNlOiBbNywgMjddLFxuICAgICAgaGlkZGVuOiBbOCwgMjhdLFxuICAgICAgc3RyaWtldGhyb3VnaDogWzksIDI5XVxuICAgIH0sXG4gICAgY29sb3I6IHtcbiAgICAgIGJsYWNrOiBbMzAsIDM5XSxcbiAgICAgIHJlZDogWzMxLCAzOV0sXG4gICAgICBncmVlbjogWzMyLCAzOV0sXG4gICAgICB5ZWxsb3c6IFszMywgMzldLFxuICAgICAgYmx1ZTogWzM0LCAzOV0sXG4gICAgICBtYWdlbnRhOiBbMzUsIDM5XSxcbiAgICAgIGN5YW46IFszNiwgMzldLFxuICAgICAgd2hpdGU6IFszNywgMzldLFxuICAgICAgZ3JheTogWzkwLCAzOV0sXG5cbiAgICAgIC8vIEJyaWdodCBjb2xvclxuICAgICAgcmVkQnJpZ2h0OiBbOTEsIDM5XSxcbiAgICAgIGdyZWVuQnJpZ2h0OiBbOTIsIDM5XSxcbiAgICAgIHllbGxvd0JyaWdodDogWzkzLCAzOV0sXG4gICAgICBibHVlQnJpZ2h0OiBbOTQsIDM5XSxcbiAgICAgIG1hZ2VudGFCcmlnaHQ6IFs5NSwgMzldLFxuICAgICAgY3lhbkJyaWdodDogWzk2LCAzOV0sXG4gICAgICB3aGl0ZUJyaWdodDogWzk3LCAzOV1cbiAgICB9LFxuICAgIGJnQ29sb3I6IHtcbiAgICAgIGJnQmxhY2s6IFs0MCwgNDldLFxuICAgICAgYmdSZWQ6IFs0MSwgNDldLFxuICAgICAgYmdHcmVlbjogWzQyLCA0OV0sXG4gICAgICBiZ1llbGxvdzogWzQzLCA0OV0sXG4gICAgICBiZ0JsdWU6IFs0NCwgNDldLFxuICAgICAgYmdNYWdlbnRhOiBbNDUsIDQ5XSxcbiAgICAgIGJnQ3lhbjogWzQ2LCA0OV0sXG4gICAgICBiZ1doaXRlOiBbNDcsIDQ5XSxcblxuICAgICAgLy8gQnJpZ2h0IGNvbG9yXG4gICAgICBiZ0JsYWNrQnJpZ2h0OiBbMTAwLCA0OV0sXG4gICAgICBiZ1JlZEJyaWdodDogWzEwMSwgNDldLFxuICAgICAgYmdHcmVlbkJyaWdodDogWzEwMiwgNDldLFxuICAgICAgYmdZZWxsb3dCcmlnaHQ6IFsxMDMsIDQ5XSxcbiAgICAgIGJnQmx1ZUJyaWdodDogWzEwNCwgNDldLFxuICAgICAgYmdNYWdlbnRhQnJpZ2h0OiBbMTA1LCA0OV0sXG4gICAgICBiZ0N5YW5CcmlnaHQ6IFsxMDYsIDQ5XSxcbiAgICAgIGJnV2hpdGVCcmlnaHQ6IFsxMDcsIDQ5XVxuICAgIH1cbiAgfTtcblxuICAvLyBGaXggaHVtYW5zXG4gIHN0eWxlcy5jb2xvci5ncmV5ID0gc3R5bGVzLmNvbG9yLmdyYXk7XG5cbiAgZm9yIChjb25zdCBncm91cE5hbWUgb2YgT2JqZWN0LmtleXMoc3R5bGVzKSkge1xuICAgIGNvbnN0IGdyb3VwID0gc3R5bGVzW2dyb3VwTmFtZV07XG5cbiAgICBmb3IgKGNvbnN0IHN0eWxlTmFtZSBvZiBPYmplY3Qua2V5cyhncm91cCkpIHtcbiAgICAgIGNvbnN0IHN0eWxlID0gZ3JvdXBbc3R5bGVOYW1lXTtcblxuICAgICAgc3R5bGVzW3N0eWxlTmFtZV0gPSB7XG4gICAgICAgIG9wZW46IGBcXHUwMDFCWyR7c3R5bGVbMF19bWAsXG4gICAgICAgIGNsb3NlOiBgXFx1MDAxQlske3N0eWxlWzFdfW1gXG4gICAgICB9O1xuXG4gICAgICBncm91cFtzdHlsZU5hbWVdID0gc3R5bGVzW3N0eWxlTmFtZV07XG5cbiAgICAgIGNvZGVzLnNldChzdHlsZVswXSwgc3R5bGVbMV0pO1xuICAgIH1cblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzdHlsZXMsIGdyb3VwTmFtZSwge1xuICAgICAgdmFsdWU6IGdyb3VwLFxuICAgICAgZW51bWVyYWJsZTogZmFsc2VcbiAgICB9KTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShzdHlsZXMsICdjb2RlcycsIHtcbiAgICAgIHZhbHVlOiBjb2RlcyxcbiAgICAgIGVudW1lcmFibGU6IGZhbHNlXG4gICAgfSk7XG4gIH1cblxuICBjb25zdCBhbnNpMmFuc2kgPSBuID0+IG47XG4gIGNvbnN0IHJnYjJyZ2IgPSAociwgZywgYikgPT4gW3IsIGcsIGJdO1xuXG4gIHN0eWxlcy5jb2xvci5jbG9zZSA9ICdcXHUwMDFCWzM5bSc7XG4gIHN0eWxlcy5iZ0NvbG9yLmNsb3NlID0gJ1xcdTAwMUJbNDltJztcblxuICBzdHlsZXMuY29sb3IuYW5zaSA9IHtcbiAgICBhbnNpOiB3cmFwQW5zaTE2KGFuc2kyYW5zaSwgMClcbiAgfTtcbiAgc3R5bGVzLmNvbG9yLmFuc2kyNTYgPSB7XG4gICAgYW5zaTI1Njogd3JhcEFuc2kyNTYoYW5zaTJhbnNpLCAwKVxuICB9O1xuICBzdHlsZXMuY29sb3IuYW5zaTE2bSA9IHtcbiAgICByZ2I6IHdyYXBBbnNpMTZtKHJnYjJyZ2IsIDApXG4gIH07XG5cbiAgc3R5bGVzLmJnQ29sb3IuYW5zaSA9IHtcbiAgICBhbnNpOiB3cmFwQW5zaTE2KGFuc2kyYW5zaSwgMTApXG4gIH07XG4gIHN0eWxlcy5iZ0NvbG9yLmFuc2kyNTYgPSB7XG4gICAgYW5zaTI1Njogd3JhcEFuc2kyNTYoYW5zaTJhbnNpLCAxMClcbiAgfTtcbiAgc3R5bGVzLmJnQ29sb3IuYW5zaTE2bSA9IHtcbiAgICByZ2I6IHdyYXBBbnNpMTZtKHJnYjJyZ2IsIDEwKVxuICB9O1xuXG4gIGZvciAobGV0IGtleSBvZiBPYmplY3Qua2V5cyhjb2xvckNvbnZlcnQpKSB7XG4gICAgaWYgKHR5cGVvZiBjb2xvckNvbnZlcnRba2V5XSAhPT0gJ29iamVjdCcpIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cblxuICAgIGNvbnN0IHN1aXRlID0gY29sb3JDb252ZXJ0W2tleV07XG5cbiAgICBpZiAoa2V5ID09PSAnYW5zaTE2Jykge1xuICAgICAga2V5ID0gJ2Fuc2knO1xuICAgIH1cblxuICAgIGlmICgnYW5zaTE2JyBpbiBzdWl0ZSkge1xuICAgICAgc3R5bGVzLmNvbG9yLmFuc2lba2V5XSA9IHdyYXBBbnNpMTYoc3VpdGUuYW5zaTE2LCAwKTtcbiAgICAgIHN0eWxlcy5iZ0NvbG9yLmFuc2lba2V5XSA9IHdyYXBBbnNpMTYoc3VpdGUuYW5zaTE2LCAxMCk7XG4gICAgfVxuXG4gICAgaWYgKCdhbnNpMjU2JyBpbiBzdWl0ZSkge1xuICAgICAgc3R5bGVzLmNvbG9yLmFuc2kyNTZba2V5XSA9IHdyYXBBbnNpMjU2KHN1aXRlLmFuc2kyNTYsIDApO1xuICAgICAgc3R5bGVzLmJnQ29sb3IuYW5zaTI1NltrZXldID0gd3JhcEFuc2kyNTYoc3VpdGUuYW5zaTI1NiwgMTApO1xuICAgIH1cblxuICAgIGlmICgncmdiJyBpbiBzdWl0ZSkge1xuICAgICAgc3R5bGVzLmNvbG9yLmFuc2kxNm1ba2V5XSA9IHdyYXBBbnNpMTZtKHN1aXRlLnJnYiwgMCk7XG4gICAgICBzdHlsZXMuYmdDb2xvci5hbnNpMTZtW2tleV0gPSB3cmFwQW5zaTE2bShzdWl0ZS5yZ2IsIDEwKTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gc3R5bGVzO1xufVxuXG4vLyBNYWtlIHRoZSBleHBvcnQgaW1tdXRhYmxlXG5PYmplY3QuZGVmaW5lUHJvcGVydHkobW9kdWxlLCAnZXhwb3J0cycsIHtcbiAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgZ2V0OiBhc3NlbWJsZVN0eWxlc1xufSk7XG4iXX0=